<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æœ€çµ‚ PDF æ•´åˆæ¸¬è©¦</title>
    <style>
        body { 
            font-family: -apple-system, BlinkMacSystemFont, sans-serif; 
            max-width: 900px; 
            margin: 0 auto; 
            padding: 20px;
            background: linear-gradient(135deg, #dc3545 0%, #c82333 100%);
            min-height: 100vh;
        }
        .container {
            background: rgba(255,255,255,0.98);
            padding: 30px;
            border-radius: 15px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.3);
            color: #333;
        }
        .test-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin: 25px 0;
        }
        .test-card {
            background: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 3px 10px rgba(0,0,0,0.1);
            border-left: 4px solid #dc3545;
        }
        .status {
            padding: 10px 15px;
            border-radius: 6px;
            margin: 10px 0;
            font-weight: 500;
        }
        .success { 
            background: linear-gradient(135deg, #d4edda 0%, #c3e6cb 100%); 
            color: #155724;
        }
        .error { 
            background: linear-gradient(135deg, #f8d7da 0%, #f5c6cb 100%); 
            color: #721c24; 
        }
        .info {
            background: linear-gradient(135deg, #d1ecf1 0%, #bee5eb 100%);
            color: #0c5460;
        }
        .warning {
            background: linear-gradient(135deg, #fff3cd 0%, #ffeeba 100%);
            color: #856404;
        }
        button {
            background: linear-gradient(135deg, #dc3545 0%, #c82333 100%);
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 600;
            margin: 6px 3px;
            transition: all 0.3s ease;
        }
        button:hover { 
            transform: translateY(-1px);
            box-shadow: 0 4px 15px rgba(220, 53, 69, 0.4);
        }
        .download-btn {
            background: linear-gradient(135deg, #28a745 0%, #20c997 100%);
            color: white;
            text-decoration: none;
            display: inline-block;
            padding: 10px 20px;
            border-radius: 6px;
            margin: 6px 3px;
            font-weight: 600;
            transition: all 0.3s ease;
        }
        .download-btn:hover {
            transform: translateY(-1px);
            text-decoration: none;
            color: white;
        }
        h1 { 
            text-align: center; 
            color: #dc3545;
            margin-bottom: 15px;
        }
        h2 { 
            color: #dc3545; 
            border-bottom: 2px solid #dc3545;
            padding-bottom: 8px;
            font-size: 1.2em;
        }
        .subtitle {
            text-align: center;
            color: #666;
            margin-bottom: 30px;
        }
        .progress-bar {
            background: #e9ecef;
            border-radius: 10px;
            overflow: hidden;
            height: 6px;
            margin: 15px 0;
        }
        .progress-fill {
            background: linear-gradient(90deg, #dc3545, #c82333);
            height: 100%;
            transition: width 0.3s ease;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ¯ æœ€çµ‚ PDF æ•´åˆæ¸¬è©¦</h1>
        <p class="subtitle">æ¸¬è©¦ä¿®å¾©å¾Œçš„å®Œæ•´ PDF è½‰æ›åŠŸèƒ½</p>
        
        <div class="progress-bar">
            <div class="progress-fill" id="overall-progress" style="width: 0%"></div>
        </div>

        <div class="test-grid">
            <div class="test-card">
                <h2>ğŸ”§ ç³»çµ±æª¢æŸ¥</h2>
                <button onclick="runSystemCheck()">ç³»çµ±ç‹€æ…‹æª¢æŸ¥</button>
                <div id="system-results"></div>
            </div>

            <div class="test-card">
                <h2>ğŸ“„ ç›´æ¥ PDF æ¸¬è©¦</h2>
                <button onclick="testDirectPDF()">ç›´æ¥ jsPDF æ¸¬è©¦</button>
                <div id="direct-pdf-results"></div>
            </div>

            <div class="test-card">
                <h2>ğŸ”„ DocumentConverter æ¸¬è©¦</h2>
                <button onclick="testDocumentConverter()">DocumentConverter æ¸¬è©¦</button>
                <div id="converter-results"></div>
            </div>

            <div class="test-card">
                <h2>ğŸ“ æ–‡å­—è½‰ PDF æ¸¬è©¦</h2>
                <button onclick="testTextToPDF()">æ–‡å­— â†’ PDF</button>
                <div id="text-pdf-results"></div>
            </div>

            <div class="test-card">
                <h2>ğŸŒ HTML è½‰ PDF æ¸¬è©¦</h2>
                <button onclick="testHTMLToPDF()">HTML â†’ PDF</button>
                <div id="html-pdf-results"></div>
            </div>

            <div class="test-card">
                <h2>ğŸ¯ ç¶œåˆ PDF æ¸¬è©¦</h2>
                <button onclick="runComprehensiveTest()">åŸ·è¡Œç¶œåˆæ¸¬è©¦</button>
                <div id="comprehensive-results"></div>
            </div>
        </div>
    </div>

    <!-- è¼‰å…¥å¿…è¦è…³æœ¬ -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="assets/js/lib-loader.js"></script>
    <script src="assets/js/converters/document.js"></script>

    <script>
        let completedTests = 0;
        const totalTests = 6;

        function updateProgress() {
            const progress = (completedTests / totalTests) * 100;
            document.getElementById('overall-progress').style.width = `${progress}%`;
        }

        function addResult(containerId, message, type = 'info', isHtml = false) {
            const container = document.getElementById(containerId);
            const div = document.createElement('div');
            div.className = `status ${type}`;
            if (isHtml) {
                div.innerHTML = message;
            } else {
                div.textContent = message;
            }
            container.appendChild(div);
            return div;
        }

        function safeDownload(blob, filename) {
            try {
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = filename;
                a.style.display = 'none';
                
                document.body.appendChild(a);
                a.click();
                document.body.removeChild(a);
                
                setTimeout(() => URL.revokeObjectURL(url), 1000);
                return true;
            } catch (error) {
                console.error('ä¸‹è¼‰å¤±æ•—:', error);
                return false;
            }
        }

        async function waitForConverter(timeout = 10000) {
            const start = Date.now();
            while (typeof DocumentConverter === 'undefined') {
                if (Date.now() - start > timeout) {
                    throw new Error('DocumentConverter è¼‰å…¥é€¾æ™‚');
                }
                await new Promise(resolve => setTimeout(resolve, 100));
            }
        }

        async function runSystemCheck() {
            const containerId = 'system-results';
            document.getElementById(containerId).innerHTML = '';
            
            try {
                addResult(containerId, 'ğŸ” æª¢æŸ¥ç³»çµ±è¼‰å…¥ç‹€æ…‹...', 'info');
                
                // æª¢æŸ¥ jsPDF
                let jsPDFAvailable = false;
                if (window.jsPDF) {
                    addResult(containerId, 'âœ… jsPDF å·²è¼‰å…¥ (window.jsPDF)', 'success');
                    jsPDFAvailable = true;
                } else if (window.jspdf && window.jspdf.jsPDF) {
                    addResult(containerId, 'âœ… jsPDF å·²è¼‰å…¥ (window.jspdf.jsPDF)', 'success');
                    jsPDFAvailable = true;
                } else {
                    addResult(containerId, 'âŒ jsPDF æœªè¼‰å…¥', 'error');
                }
                
                // æ¸¬è©¦ jsPDF å¯¦ä¾‹åŒ–
                if (jsPDFAvailable) {
                    try {
                        const jsPDFConstructor = window.jsPDF || window.jspdf.jsPDF;
                        const testDoc = new jsPDFConstructor();
                        addResult(containerId, 'âœ… jsPDF å¯¦ä¾‹åŒ–æ¸¬è©¦é€šé', 'success');
                    } catch (error) {
                        addResult(containerId, `âŒ jsPDF å¯¦ä¾‹åŒ–å¤±æ•—: ${error.message}`, 'error');
                    }
                }
                
                // æª¢æŸ¥ DocumentConverter
                try {
                    await waitForConverter(3000);
                    addResult(containerId, 'âœ… DocumentConverter å·²è¼‰å…¥', 'success');
                    
                    // æª¢æŸ¥é—œéµæ–¹æ³•
                    const methods = ['convertToPdf', 'createPdfWithJsPDF', 'loadJsPDF'];
                    methods.forEach(method => {
                        if (typeof DocumentConverter[method] === 'function') {
                            addResult(containerId, `âœ… ${method} æ–¹æ³•å¯ç”¨`, 'success');
                        } else {
                            addResult(containerId, `âŒ ${method} æ–¹æ³•æœªæ‰¾åˆ°`, 'error');
                        }
                    });
                } catch (error) {
                    addResult(containerId, `âŒ DocumentConverter è¼‰å…¥å¤±æ•—: ${error.message}`, 'error');
                }
                
                completedTests++;
                updateProgress();
                
            } catch (error) {
                addResult(containerId, `âŒ ç³»çµ±æª¢æŸ¥å¤±æ•—: ${error.message}`, 'error');
            }
        }

        async function testDirectPDF() {
            const containerId = 'direct-pdf-results';
            document.getElementById(containerId).innerHTML = '';
            
            try {
                addResult(containerId, 'ğŸ”„ ç›´æ¥æ¸¬è©¦ jsPDF...', 'info');
                
                const jsPDFConstructor = window.jsPDF || (window.jspdf && window.jspdf.jsPDF);
                if (!jsPDFConstructor) {
                    throw new Error('jsPDF æ§‹é€ å‡½æ•¸æœªæ‰¾åˆ°');
                }
                
                const doc = new jsPDFConstructor();
                doc.text('ç›´æ¥ jsPDF æ¸¬è©¦', 20, 20);
                doc.text('Direct jsPDF Test', 20, 30);
                doc.text(`ç”Ÿæˆæ™‚é–“: ${new Date().toLocaleString()}`, 20, 40);
                
                const pdfBlob = doc.output('blob');
                
                addResult(containerId, `âœ… ç›´æ¥ PDF ç”ŸæˆæˆåŠŸï¼å¤§å°: ${(pdfBlob.size / 1024).toFixed(1)} KB`, 'success');
                
                // é©—è­‰ PDF æ ¼å¼
                const arrayBuffer = await pdfBlob.arrayBuffer();
                const header = new Uint8Array(arrayBuffer.slice(0, 4));
                const headerString = String.fromCharCode(...header);
                
                if (headerString === '%PDF') {
                    addResult(containerId, 'âœ… PDF æª”æ¡ˆæ ¼å¼é©—è­‰é€šé', 'success');
                    
                    const downloadDiv = document.createElement('div');
                    downloadDiv.innerHTML = `
                        <a href="#" class="download-btn" onclick="safeDownload(window.directPdfBlob, 'direct-test.pdf'); return false;">
                            ğŸ“„ ä¸‹è¼‰ç›´æ¥ç”Ÿæˆçš„ PDF
                        </a>
                    `;
                    document.getElementById(containerId).appendChild(downloadDiv);
                    window.directPdfBlob = pdfBlob;
                } else {
                    addResult(containerId, `âŒ PDF æª”æ¡ˆæ ¼å¼éŒ¯èª¤: ${headerString}`, 'error');
                }
                
                completedTests++;
                updateProgress();
                
            } catch (error) {
                addResult(containerId, `âŒ ç›´æ¥ PDF æ¸¬è©¦å¤±æ•—: ${error.message}`, 'error');
            }
        }

        async function testDocumentConverter() {
            const containerId = 'converter-results';
            document.getElementById(containerId).innerHTML = '';
            
            try {
                await waitForConverter();
                
                addResult(containerId, 'ğŸ”„ æ¸¬è©¦ DocumentConverter.convertToPdf...', 'info');
                
                const testContent = `DocumentConverter æ¸¬è©¦

é€™æ˜¯ä½¿ç”¨ DocumentConverter.convertToPdf æ–¹æ³•ç”Ÿæˆçš„ PDF æª”æ¡ˆã€‚

æ¸¬è©¦å…§å®¹ï¼š
1. åŸºæœ¬æ–‡å­—é¡¯ç¤º
2. ä¸­æ–‡å­—ç¬¦æ¸¬è©¦
3. è‹±æ–‡å­—ç¬¦æ¸¬è©¦
4. æ•¸å­—æ¸¬è©¦: 123456789
5. ç‰¹æ®Šå­—ç¬¦æ¸¬è©¦: !@#$%^&*()

å¦‚æœæ‚¨èƒ½æ­£å¸¸é–‹å•Ÿä¸¦é–±è®€æ­¤æª”æ¡ˆï¼Œè¡¨ç¤º DocumentConverter çš„ PDF è½‰æ›åŠŸèƒ½é‹ä½œæ­£å¸¸ã€‚

ç”Ÿæˆæ™‚é–“: ${new Date().toLocaleString()}`;

                const pdfBlob = await DocumentConverter.convertToPdf(testContent, 'DocumentConverter æ¸¬è©¦');
                
                addResult(containerId, `âœ… DocumentConverter PDF ç”ŸæˆæˆåŠŸï¼å¤§å°: ${(pdfBlob.size / 1024).toFixed(1)} KB`, 'success');
                
                const downloadDiv = document.createElement('div');
                downloadDiv.innerHTML = `
                    <a href="#" class="download-btn" onclick="safeDownload(window.converterPdfBlob, 'converter-test.pdf'); return false;">
                        ğŸ“„ ä¸‹è¼‰ DocumentConverter ç”Ÿæˆçš„ PDF
                    </a>
                `;
                document.getElementById(containerId).appendChild(downloadDiv);
                window.converterPdfBlob = pdfBlob;
                
                completedTests++;
                updateProgress();
                
            } catch (error) {
                addResult(containerId, `âŒ DocumentConverter æ¸¬è©¦å¤±æ•—: ${error.message}`, 'error');
                console.error('DocumentConverter test error:', error);
            }
        }

        async function testTextToPDF() {
            const containerId = 'text-pdf-results';
            document.getElementById(containerId).innerHTML = '';
            
            try {
                await waitForConverter();
                
                addResult(containerId, 'ğŸ”„ æ–‡å­—è½‰ PDF æ¸¬è©¦...', 'info');
                
                const longText = `æ–‡å­—è½‰ PDF åŠŸèƒ½æ¸¬è©¦å ±å‘Š

æœ¬æ¸¬è©¦æ—¨åœ¨é©—è­‰é•·ç¯‡æ–‡å­—å…§å®¹èƒ½å¦æ­£ç¢ºè½‰æ›ç‚º PDF æ ¼å¼ã€‚

ç¬¬ä¸€æ®µï¼šåŸºæœ¬åŠŸèƒ½æ¸¬è©¦
é€™æ˜¯ç¬¬ä¸€æ®µå…§å®¹ï¼Œç”¨ä¾†æ¸¬è©¦åŸºæœ¬çš„æ–‡å­—è½‰æ›åŠŸèƒ½ã€‚PDF æ‡‰è©²èƒ½å¤ æ­£ç¢ºé¡¯ç¤ºä¸­æ–‡å­—ç¬¦ã€è‹±æ–‡å­—ç¬¦ã€æ•¸å­—å’Œæ¨™é»ç¬¦è™Ÿã€‚

ç¬¬äºŒæ®µï¼šæ ¼å¼æ¸¬è©¦
é€™æ˜¯ç¬¬äºŒæ®µå…§å®¹ï¼Œæ¸¬è©¦æ®µè½é–“çš„é–“è·å’Œæ›è¡ŒåŠŸèƒ½ã€‚æ¯å€‹æ®µè½ä¹‹é–“æ‡‰è©²æœ‰é©ç•¶çš„é–“è·ï¼Œä½¿æ–‡ä»¶çœ‹èµ·ä¾†æ•´æ½”æœ‰åºã€‚

ç¬¬ä¸‰æ®µï¼šç‰¹æ®Šå­—ç¬¦æ¸¬è©¦
é€™æ˜¯ç¬¬ä¸‰æ®µï¼ŒåŒ…å«ä¸€äº›ç‰¹æ®Šå­—ç¬¦ï¼š
â€¢ é …ç›®ç¬¦è™Ÿæ¸¬è©¦
â€¢ æ•¸å­—æ¸¬è©¦ï¼š1234567890
â€¢ è‹±æ–‡æ¸¬è©¦ï¼šThe quick brown fox jumps over the lazy dog
â€¢ ç‰¹æ®Šç¬¦è™Ÿï¼š!@#$%^&*()[]{}

ç¬¬å››æ®µï¼šé•·æ®µè½æ¸¬è©¦
é€™æ˜¯ä¸€å€‹è¼ƒé•·çš„æ®µè½ï¼Œç”¨ä¾†æ¸¬è©¦ PDF ç”Ÿæˆå™¨çš„æ–‡å­—æ›è¡ŒåŠŸèƒ½ã€‚ç•¶ä¸€è¡Œæ–‡å­—è¶…éé é¢å¯¬åº¦æ™‚ï¼Œæ‡‰è©²èƒ½å¤ è‡ªå‹•æ›è¡Œåˆ°ä¸‹ä¸€è¡Œï¼Œä¸¦ä¿æŒæ–‡å­—çš„å¯è®€æ€§ã€‚é€™å€‹åŠŸèƒ½å°æ–¼ç”Ÿæˆå°ˆæ¥­çš„ PDF æ–‡ä»¶éå¸¸é‡è¦ã€‚

ç¬¬äº”æ®µï¼šå¤šé æ¸¬è©¦
å¦‚æœå…§å®¹è¶³å¤ é•·ï¼ŒPDF ç”Ÿæˆå™¨æ‡‰è©²èƒ½å¤ è‡ªå‹•å‰µå»ºæ–°é é¢ã€‚æ¯å€‹é é¢éƒ½æ‡‰è©²æœ‰é©ç•¶çš„é‚Šè·å’Œæ ¼å¼è¨­å®šã€‚

æŠ€è¡“è¦æ ¼ï¼š
- é é¢æ ¼å¼ï¼šA4
- å­—é«”ï¼šHelvetica
- å­—é«”å¤§å°ï¼š12pt
- é‚Šè·ï¼š20mm
- è¡Œè·ï¼š7pt

æ¸¬è©¦çµè«–ï¼š
å¦‚æœæ‚¨èƒ½æ­£å¸¸é–‹å•Ÿä¸¦é–±è®€æ­¤ PDF æ–‡ä»¶ï¼Œä¸”æ‰€æœ‰å…§å®¹éƒ½æ­£ç¢ºé¡¯ç¤ºï¼Œè¡¨ç¤ºæ–‡å­—è½‰ PDF åŠŸèƒ½é‹ä½œæ­£å¸¸ã€‚

ç”Ÿæˆæ™‚é–“ï¼š${new Date().toLocaleString()}
æ¸¬è©¦ç‰ˆæœ¬ï¼šv1.0`;

                const pdfBlob = await DocumentConverter.convertToPdf(longText, 'æ–‡å­—è½‰PDFæ¸¬è©¦å ±å‘Š');
                
                addResult(containerId, `âœ… æ–‡å­—è½‰ PDF æˆåŠŸï¼å¤§å°: ${(pdfBlob.size / 1024).toFixed(1)} KB`, 'success');
                
                const downloadDiv = document.createElement('div');
                downloadDiv.innerHTML = `
                    <a href="#" class="download-btn" onclick="safeDownload(window.textPdfBlob, 'text-to-pdf-test.pdf'); return false;">
                        ğŸ“„ ä¸‹è¼‰æ–‡å­—è½‰ PDF æª”æ¡ˆ
                    </a>
                `;
                document.getElementById(containerId).appendChild(downloadDiv);
                window.textPdfBlob = pdfBlob;
                
                completedTests++;
                updateProgress();
                
            } catch (error) {
                addResult(containerId, `âŒ æ–‡å­—è½‰ PDF å¤±æ•—: ${error.message}`, 'error');
            }
        }

        async function testHTMLToPDF() {
            const containerId = 'html-pdf-results';
            document.getElementById(containerId).innerHTML = '';
            
            try {
                await waitForConverter();
                
                addResult(containerId, 'ğŸ”„ HTML è½‰ PDF æ¸¬è©¦...', 'info');
                
                const htmlContent = `<h1>HTML è½‰ PDF æ¸¬è©¦å ±å‘Š</h1>
                
<h2>æ¸¬è©¦é …ç›®</h2>
<ul>
    <li>HTML æ¨™ç±¤æ”¯æ´</li>
    <li>æ¨™é¡Œå±¤ç´šæ¸¬è©¦</li>
    <li>åˆ—è¡¨åŠŸèƒ½æ¸¬è©¦</li>
    <li>æ®µè½æ ¼å¼æ¸¬è©¦</li>
</ul>

<h2>æŠ€è¡“è¦æ ¼</h2>
<p>æœ¬æ¸¬è©¦ä½¿ç”¨ <strong>DocumentConverter</strong> çš„ HTML è½‰ PDF åŠŸèƒ½ã€‚</p>

<h3>æ”¯æ´çš„ HTML æ¨™ç±¤</h3>
<ul>
    <li><strong>æ¨™é¡Œæ¨™ç±¤</strong>: H1, H2, H3 ç­‰</li>
    <li><strong>æ®µè½æ¨™ç±¤</strong>: P, DIV</li>
    <li><strong>åˆ—è¡¨æ¨™ç±¤</strong>: UL, OL, LI</li>
    <li><strong>æ ¼å¼æ¨™ç±¤</strong>: STRONG, EM</li>
</ul>

<h2>æ¸¬è©¦çµè«–</h2>
<p>å¦‚æœæ‚¨èƒ½çœ‹åˆ°å®Œæ•´çš„ HTML æ ¼å¼å…§å®¹ï¼Œè¡¨ç¤º HTML è½‰ PDF åŠŸèƒ½é‹ä½œæ­£å¸¸ã€‚</p>

<p><em>ç”Ÿæˆæ™‚é–“: ${new Date().toLocaleString()}</em></p>`;

                const pdfBlob = await DocumentConverter.createHtmlToPdf(htmlContent, 'HTMLè½‰PDFæ¸¬è©¦å ±å‘Š');
                
                addResult(containerId, `âœ… HTML è½‰ PDF æˆåŠŸï¼å¤§å°: ${(pdfBlob.size / 1024).toFixed(1)} KB`, 'success');
                addResult(containerId, 'â„¹ï¸ æ³¨æ„ï¼šæ­¤ç‚º HTML æ ¼å¼æª”æ¡ˆï¼Œå¯ç”¨ç€è¦½å™¨é–‹å•Ÿå¾Œåˆ—å°ç‚º PDF', 'info');
                
                const downloadDiv = document.createElement('div');
                downloadDiv.innerHTML = `
                    <a href="#" class="download-btn" onclick="safeDownload(window.htmlPdfBlob, 'html-to-pdf-test.html'); return false;">
                        ğŸŒ ä¸‹è¼‰ HTML æª”æ¡ˆ (å¯åˆ—å°ç‚º PDF)
                    </a>
                `;
                document.getElementById(containerId).appendChild(downloadDiv);
                window.htmlPdfBlob = pdfBlob;
                
                completedTests++;
                updateProgress();
                
            } catch (error) {
                addResult(containerId, `âŒ HTML è½‰ PDF å¤±æ•—: ${error.message}`, 'error');
            }
        }

        async function runComprehensiveTest() {
            const containerId = 'comprehensive-results';
            document.getElementById(containerId).innerHTML = '';
            
            try {
                await waitForConverter();
                
                addResult(containerId, 'ğŸ”„ åŸ·è¡Œç¶œåˆ PDF æ¸¬è©¦...', 'info');
                
                const tests = [
                    {
                        name: 'ç°¡çŸ­æ–‡å­—',
                        content: 'é€™æ˜¯ä¸€å€‹ç°¡çŸ­çš„ PDF æ¸¬è©¦ã€‚',
                        title: 'ç°¡çŸ­æ¸¬è©¦'
                    },
                    {
                        name: 'ä¸­ç­‰é•·åº¦æ–‡å­—',
                        content: `ä¸­ç­‰é•·åº¦æ–‡å­—æ¸¬è©¦

é€™æ˜¯ä¸€å€‹ä¸­ç­‰é•·åº¦çš„ PDF æ¸¬è©¦æ–‡ä»¶ã€‚

å…§å®¹åŒ…æ‹¬ï¼š
â€¢ å¤šæ®µè½æ–‡å­—
â€¢ ä¸­æ–‡å­—ç¬¦æ¸¬è©¦
â€¢ English character test
â€¢ æ•¸å­—æ¸¬è©¦ï¼š123456789

æ¸¬è©¦æ™‚é–“ï¼š${new Date().toLocaleString()}`,
                        title: 'ä¸­ç­‰æ¸¬è©¦'
                    },
                    {
                        name: 'é•·ç¯‡æ–‡å­—',
                        content: Array(50).fill('é€™æ˜¯é•·ç¯‡æ–‡å­—æ¸¬è©¦çš„æ®µè½å…§å®¹ã€‚').join(' '),
                        title: 'é•·ç¯‡æ¸¬è©¦'
                    }
                ];
                
                const results = [];
                
                for (let i = 0; i < tests.length; i++) {
                    const test = tests[i];
                    try {
                        addResult(containerId, `ğŸ”„ æ¸¬è©¦ ${i + 1}: ${test.name}`, 'info');
                        
                        const blob = await DocumentConverter.convertToPdf(test.content, test.title);
                        
                        if (blob.size > 100) {
                            addResult(containerId, `âœ… ${test.name} æˆåŠŸ (${(blob.size / 1024).toFixed(1)} KB)`, 'success');
                            results.push({ ...test, blob, index: i });
                        } else {
                            addResult(containerId, `âŒ ${test.name} å¤±æ•— - æª”æ¡ˆéå°`, 'error');
                        }
                        
                    } catch (testError) {
                        addResult(containerId, `âŒ ${test.name} å¤±æ•—: ${testError.message}`, 'error');
                    }
                }
                
                if (results.length > 0) {
                    addResult(containerId, `âœ… ç¶œåˆæ¸¬è©¦å®Œæˆï¼æˆåŠŸç”Ÿæˆ ${results.length} å€‹ PDF æª”æ¡ˆ`, 'success');
                    
                    const downloadDiv = document.createElement('div');
                    downloadDiv.innerHTML = `
                        <strong>ğŸ‰ ç¶œåˆæ¸¬è©¦çµæœ</strong><br>
                        æˆåŠŸæ¸¬è©¦: ${results.length} / ${tests.length}<br><br>
                        ${results.map(result => 
                            `<a href="#" class="download-btn" onclick="safeDownload(window.comprehensivePdfBlobs[${result.index}], '${result.name.replace(/\s+/g, '-')}-test.pdf'); return false;">
                                ğŸ“„ ${result.name}
                            </a>`
                        ).join('')}
                    `;
                    document.getElementById(containerId).appendChild(downloadDiv);
                    window.comprehensivePdfBlobs = results.map(r => r.blob);
                }
                
                completedTests++;
                updateProgress();
                
            } catch (error) {
                addResult(containerId, `âŒ ç¶œåˆæ¸¬è©¦å¤±æ•—: ${error.message}`, 'error');
            }
        }

        // å…¨åŸŸå‡½æ•¸è¨»å†Š
        window.runSystemCheck = runSystemCheck;
        window.testDirectPDF = testDirectPDF;
        window.testDocumentConverter = testDocumentConverter;
        window.testTextToPDF = testTextToPDF;
        window.testHTMLToPDF = testHTMLToPDF;
        window.runComprehensiveTest = runComprehensiveTest;

        // é é¢è¼‰å…¥å®Œæˆå¾Œè‡ªå‹•åŸ·è¡Œç³»çµ±æª¢æŸ¥
        window.addEventListener('load', () => {
            setTimeout(runSystemCheck, 1000);
        });
    </script>
</body>
</html>