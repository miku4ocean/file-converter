<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>çœŸå¯¦æª”æ¡ˆæ ¼å¼è½‰æ›æ¸¬è©¦</title>
    <style>
        body { font-family: Arial, sans-serif; padding: 20px; max-width: 1200px; margin: 0 auto; }
        .test-panel { background: #f8f9fa; padding: 20px; margin: 20px 0; border-radius: 8px; border: 1px solid #dee2e6; }
        .test-btn { background: #007bff; color: white; border: none; padding: 12px 24px; margin: 5px; cursor: pointer; border-radius: 5px; font-size: 14px; }
        .test-btn:hover { background: #0056b3; }
        .test-btn:disabled { background: #6c757d; cursor: not-allowed; }
        .success { color: #28a745; font-weight: bold; }
        .error { color: #dc3545; font-weight: bold; }
        .warning { color: #ffc107; font-weight: bold; }
        .info { color: #17a2b8; }
        .results { margin: 15px 0; padding: 15px; background: white; border-radius: 5px; border: 1px solid #ddd; }
        .download-link { display: inline-block; padding: 8px 16px; background: #28a745; color: white; text-decoration: none; border-radius: 4px; margin: 5px 0; }
        .download-link:hover { background: #218838; color: white; }
        .file-info { background: #e9ecef; padding: 10px; border-radius: 4px; margin: 10px 0; font-family: monospace; font-size: 12px; }
        .library-status { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 10px; margin: 20px 0; }
        .lib-card { background: white; border: 1px solid #ddd; border-radius: 5px; padding: 10px; text-align: center; }
        .lib-loaded { border-color: #28a745; background-color: #d4edda; }
        .lib-failed { border-color: #dc3545; background-color: #f8d7da; }
        pre { background: #f8f9fa; padding: 10px; border-radius: 4px; font-size: 11px; overflow-x: auto; }
    </style>
</head>
<body>
    <h1>ğŸ” çœŸå¯¦æª”æ¡ˆæ ¼å¼è½‰æ›é©—è­‰</h1>
    <p>é€™å€‹æ¸¬è©¦é é¢å°ˆé–€ç”¨ä¾†é©—è­‰è½‰æ›å¾Œçš„æª”æ¡ˆæ˜¯å¦èƒ½è¢«çœŸå¯¦çš„æ‡‰ç”¨ç¨‹å¼é–‹å•Ÿã€‚</p>
    
    <div class="test-panel">
        <h2>ğŸ“š å‡½å¼åº«è¼‰å…¥ç‹€æ…‹</h2>
        <button class="test-btn" onclick="checkLibraries()">æª¢æŸ¥å‡½å¼åº«ç‹€æ…‹</button>
        <button class="test-btn" onclick="preloadLibraries()">é è¼‰å…¥é‡è¦å‡½å¼åº«</button>
        
        <div id="libraryStatus" class="library-status"></div>
    </div>

    <div class="test-panel">
        <h2>ğŸ“„ DOCX è½‰æ›æ¸¬è©¦</h2>
        <p>æ¸¬è©¦ç”¢ç”ŸçœŸæ­£å¯ä»¥è¢« Microsoft Word æˆ– LibreOffice é–‹å•Ÿçš„ DOCX æª”æ¡ˆ</p>
        
        <button class="test-btn" onclick="testDocxGeneration()">ç”Ÿæˆæ¸¬è©¦ DOCX æª”æ¡ˆ</button>
        <button class="test-btn" onclick="testAdvancedDocx()">ç”Ÿæˆé€²éš DOCX æª”æ¡ˆ</button>
        
        <div id="docxResults" class="results"></div>
    </div>

    <div class="test-panel">
        <h2>ğŸ“Š XLSX è½‰æ›æ¸¬è©¦</h2>
        <p>æ¸¬è©¦ç”¢ç”ŸçœŸæ­£å¯ä»¥è¢« Microsoft Excel æˆ– LibreOffice Calc é–‹å•Ÿçš„ XLSX æª”æ¡ˆ</p>
        
        <button class="test-btn" onclick="testXlsxGeneration()">ç”Ÿæˆæ¸¬è©¦ XLSX æª”æ¡ˆ</button>
        <button class="test-btn" onclick="testComplexXlsx()">ç”Ÿæˆè¤‡é›œ XLSX æª”æ¡ˆ</button>
        
        <div id="xlsxResults" class="results"></div>
    </div>

    <div class="test-panel">
        <h2>ğŸ“‹ PDF è½‰æ›æ¸¬è©¦</h2>
        <p>æ¸¬è©¦ç”¢ç”ŸçœŸæ­£å¯ä»¥è¢« PDF é–±è®€å™¨é–‹å•Ÿçš„ PDF æª”æ¡ˆ</p>
        
        <button class="test-btn" onclick="testPdfGeneration()">ç”Ÿæˆæ¸¬è©¦ PDF æª”æ¡ˆ</button>
        <button class="test-btn" onclick="testMultiPagePdf()">ç”Ÿæˆå¤šé  PDF æª”æ¡ˆ</button>
        
        <div id="pdfResults" class="results"></div>
    </div>

    <!-- Load all necessary scripts -->
    <script src="assets/js/lib-loader.js"></script>
    <script src="assets/js/converters/image.js"></script>
    <script src="assets/js/converters/document.js"></script>
    <script src="assets/js/converters/spreadsheet.js"></script>
    <script src="assets/js/converters/presentation.js"></script>
    <script src="assets/js/app.js"></script>
    <script src="assets/js/auto-loader.js"></script>

    <script>
        function log(message, type = 'info') {
            const timestamp = new Date().toLocaleTimeString();
            const className = type === 'success' ? 'success' : type === 'error' ? 'error' : type === 'warning' ? 'warning' : 'info';
            return `<div class="${className}">[${timestamp}] ${message}</div>`;
        }

        function createDownloadLink(blob, filename, description) {
            const url = URL.createObjectURL(blob);
            return `<a href="${url}" download="${filename}" class="download-link">ğŸ“¥ ä¸‹è¼‰ ${description} (${formatBytes(blob.size)})</a>`;
        }

        function formatBytes(bytes) {
            if (bytes === 0) return '0 Bytes';
            const k = 1024;
            const sizes = ['Bytes', 'KB', 'MB', 'GB'];
            const i = Math.floor(Math.log(bytes) / Math.log(k));
            return parseFloat((bytes / Math.pow(k, i)).toFixed(2)) + ' ' + sizes[i];
        }

        function checkLibraries() {
            const statusDiv = document.getElementById('libraryStatus');
            
            if (!window.libLoader) {
                statusDiv.innerHTML = '<div class="error">LibraryLoader ä¸å¯ç”¨</div>';
                return;
            }

            const status = window.libLoader.getLibraryStatus();
            let html = '';
            
            Object.entries(status).forEach(([name, info]) => {
                const cardClass = info.loaded ? 'lib-card lib-loaded' : 'lib-card lib-failed';
                const icon = info.loaded ? 'âœ…' : 'âŒ';
                html += `
                    <div class="${cardClass}">
                        <div>${icon} <strong>${name}</strong></div>
                        <div style="font-size: 12px; margin-top: 5px;">${info.description}</div>
                        <div style="font-size: 11px; color: #666;">${info.loaded ? 'å·²è¼‰å…¥' : 'æœªè¼‰å…¥'}</div>
                    </div>
                `;
            });
            
            statusDiv.innerHTML = html;
        }

        async function preloadLibraries() {
            const criticalLibs = ['jszip', 'jspdf', 'sheetjs'];
            const statusDiv = document.getElementById('libraryStatus');
            
            statusDiv.innerHTML = '<div class="info">æ­£åœ¨è¼‰å…¥å‡½å¼åº«...</div>';
            
            for (const libName of criticalLibs) {
                try {
                    await window.libLoader.loadLibrary(libName);
                    console.log(`âœ… ${libName} è¼‰å…¥æˆåŠŸ`);
                } catch (error) {
                    console.error(`âŒ ${libName} è¼‰å…¥å¤±æ•—:`, error);
                }
            }
            
            checkLibraries();
        }

        async function testDocxGeneration() {
            const resultsDiv = document.getElementById('docxResults');
            let output = '<h4>DOCX æ ¼å¼æ¸¬è©¦</h4>';
            
            try {
                output += log('é–‹å§‹ç”ŸæˆçœŸå¯¦ DOCX æª”æ¡ˆ...', 'info');
                
                const testContent = {
                    title: 'DOCX æ ¼å¼æ¸¬è©¦æ–‡ä»¶',
                    content: `é€™æ˜¯ä¸€å€‹æ¸¬è©¦ DOCX æª”æ¡ˆçš„ç”ŸæˆåŠŸèƒ½ã€‚

æœ¬æª”æ¡ˆåŒ…å«ä»¥ä¸‹å…§å®¹ï¼š
â€¢ ä¸­æ–‡å­—ç¬¦æ”¯æ´æ¸¬è©¦
â€¢ æ®µè½æ ¼å¼æ¸¬è©¦  
â€¢ ç‰¹æ®Šç¬¦è™Ÿæ¸¬è©¦ï¼šÂ©Â®â„¢â‚¬Â£Â¥

å¦‚æœæ‚¨èƒ½åœ¨ Microsoft Word æˆ– LibreOffice Writer ä¸­æ­£å¸¸é–‹å•Ÿä¸¦çœ‹åˆ°é€™äº›å…§å®¹ï¼Œ
è¡¨ç¤º DOCX è½‰æ›åŠŸèƒ½é‹ä½œæ­£å¸¸ã€‚

æ¸¬è©¦æ•¸æ“šï¼š
æ•¸å­—ï¼š123456789
è‹±æ–‡ï¼šThe quick brown fox jumps over the lazy dog
æ—¥æœŸï¼š${new Date().toLocaleDateString()}

é€™å€‹æª”æ¡ˆæ˜¯ç”±ç¶²é ç‰ˆæª”æ¡ˆè½‰æ›å™¨è‡ªå‹•ç”Ÿæˆçš„çœŸå¯¦ DOCX æª”æ¡ˆã€‚`,
                    originalHtml: null
                };
                
                const docxBlob = await DocumentConverter.convertToFormat(testContent, 'docx');
                
                if (docxBlob && docxBlob.size > 0) {
                    output += log(`âœ… DOCX æª”æ¡ˆç”ŸæˆæˆåŠŸï¼æª”æ¡ˆå¤§å°ï¼š${formatBytes(docxBlob.size)}`, 'success');
                    
                    // File signature check
                    const arrayBuffer = await docxBlob.slice(0, 4).arrayBuffer();
                    const signature = new Uint8Array(arrayBuffer);
                    const signatureHex = Array.from(signature).map(b => b.toString(16).padStart(2, '0')).join('');
                    
                    if (signatureHex === '504b0304') {
                        output += log('âœ… æª”æ¡ˆç°½åé©—è­‰é€šéï¼šé€™æ˜¯ä¸€å€‹çœŸæ­£çš„ ZIP/DOCX æª”æ¡ˆ', 'success');
                    } else {
                        output += log(`âš ï¸ æª”æ¡ˆç°½åç•°å¸¸ï¼š${signatureHex} (æ‡‰è©²æ˜¯ 504b0304)`, 'warning');
                    }
                    
                    output += createDownloadLink(docxBlob, 'test-document.docx', 'DOCX æ¸¬è©¦æª”æ¡ˆ');
                    output += '<div class="info">ğŸ’¡ è«‹ä¸‹è¼‰å¾Œç”¨ Microsoft Word æˆ– LibreOffice Writer é–‹å•Ÿé©—è­‰</div>';
                } else {
                    output += log('âŒ DOCX æª”æ¡ˆç”Ÿæˆå¤±æ•—ï¼šæª”æ¡ˆç‚ºç©º', 'error');
                }
                
            } catch (error) {
                output += log(`âŒ DOCX ç”ŸæˆéŒ¯èª¤ï¼š${error.message}`, 'error');
                console.error('DOCX æ¸¬è©¦éŒ¯èª¤:', error);
            }
            
            resultsDiv.innerHTML = output;
        }

        async function testAdvancedDocx() {
            const resultsDiv = document.getElementById('docxResults');
            let output = '<h4>é€²éš DOCX æ ¼å¼æ¸¬è©¦</h4>';
            
            try {
                const advancedContent = {
                    title: 'é€²éš DOCX åŠŸèƒ½æ¸¬è©¦',
                    content: `é€™æ˜¯é€²éš DOCX æ¸¬è©¦æ–‡ä»¶ï¼ŒåŒ…å«æ›´è¤‡é›œçš„å…§å®¹çµæ§‹ã€‚

ç¬¬ä¸€æ®µï¼šåŸºæœ¬æ–‡å­—å…§å®¹
åŒ…å«æ›è¡Œå’Œæ®µè½åˆ†éš”ã€‚

ç¬¬äºŒæ®µï¼šç‰¹æ®Šå­—ç¬¦æ¸¬è©¦
ä¸­æ–‡ï¼šä½ å¥½ä¸–ç•Œï¼
è‹±æ–‡ï¼šHello World!
æ•¸å­—ï¼š1234567890
ç¬¦è™Ÿï¼š!@#$%^&*()_+-=[]{}|;:'",./<>?
æ­å…ƒï¼šâ‚¬ è‹±éŠï¼šÂ£ æ—¥å…ƒï¼šÂ¥
ç‰ˆæ¬Šï¼šÂ© è¨»å†Šå•†æ¨™ï¼šÂ® å•†æ¨™ï¼šâ„¢

ç¬¬ä¸‰æ®µï¼šé•·æ–‡å­—æ¸¬è©¦
Lorem ipsum dolor sit amet, consectetur adipiscing elit. Sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat.

ç¬¬å››æ®µï¼šå¤šè¡Œå…§å®¹
è¡Œä¸€ï¼šé€™æ˜¯ç¬¬ä¸€è¡Œ
è¡ŒäºŒï¼šé€™æ˜¯ç¬¬äºŒè¡Œ  
è¡Œä¸‰ï¼šé€™æ˜¯ç¬¬ä¸‰è¡Œ
è¡Œå››ï¼šé€™æ˜¯æœ€å¾Œä¸€è¡Œ

æª”æ¡ˆè³‡è¨Šï¼š
ç”Ÿæˆæ™‚é–“ï¼š${new Date().toLocaleString()}
ç”Ÿæˆå·¥å…·ï¼šæª”æ¡ˆæ ¼å¼è½‰æ›å™¨ v2.0
æª”æ¡ˆé¡å‹ï¼šMicrosoft Word Document (.docx)`,
                    originalHtml: null
                };
                
                const docxBlob = await DocumentConverter.convertToFormat(advancedContent, 'docx');
                
                if (docxBlob && docxBlob.size > 0) {
                    output += log(`âœ… é€²éš DOCX æª”æ¡ˆç”ŸæˆæˆåŠŸï¼æª”æ¡ˆå¤§å°ï¼š${formatBytes(docxBlob.size)}`, 'success');
                    output += createDownloadLink(docxBlob, 'advanced-test.docx', 'é€²éš DOCX æ¸¬è©¦æª”æ¡ˆ');
                } else {
                    output += log('âŒ é€²éš DOCX æª”æ¡ˆç”Ÿæˆå¤±æ•—', 'error');
                }
                
            } catch (error) {
                output += log(`âŒ é€²éš DOCX ç”ŸæˆéŒ¯èª¤ï¼š${error.message}`, 'error');
            }
            
            resultsDiv.innerHTML = output;
        }

        async function testXlsxGeneration() {
            const resultsDiv = document.getElementById('xlsxResults');
            let output = '<h4>XLSX æ ¼å¼æ¸¬è©¦</h4>';
            
            try {
                output += log('é–‹å§‹ç”ŸæˆçœŸå¯¦ XLSX æª”æ¡ˆ...', 'info');
                
                const testData = {
                    data: [
                        ['å§“å', 'å¹´é½¡', 'åŸå¸‚', 'è·æ¥­', 'è–ªè³‡'],
                        ['å¼µä¸‰', 28, 'å°åŒ—', 'è»Ÿé«”å·¥ç¨‹å¸«', 80000],
                        ['æå››', 32, 'å°ä¸­', 'è¨­è¨ˆå¸«', 65000],
                        ['ç‹äº”', 29, 'é«˜é›„', 'è¡ŒéŠ·å°ˆå“¡', 55000],
                        ['è¶™å…­', 35, 'æ–°ç«¹', 'ç”¢å“ç¶“ç†', 95000],
                        ['éŒ¢ä¸ƒ', 26, 'å°å—', 'æ•¸æ“šåˆ†æå¸«', 70000],
                        ['å­«å…«', 31, 'æ¡ƒåœ’', 'å°ˆæ¡ˆç¶“ç†', 85000],
                        ['', '', '', '', ''],
                        ['çµ±è¨ˆè³‡æ–™', '', '', '', ''],
                        ['å¹³å‡å¹´é½¡', '=AVERAGE(B2:B7)', '', '', ''],
                        ['æœ€é«˜è–ªè³‡', '=MAX(E2:E7)', '', '', ''],
                        ['æœ€ä½è–ªè³‡', '=MIN(E2:E7)', '', '', '']
                    ],
                    sheets: [{ name: 'Sheet1', data: [] }],
                    fileName: 'test-data',
                    rowCount: 12,
                    columnCount: 5
                };
                
                const xlsxBlob = await SpreadsheetConverter.convertToFormat(testData, 'xlsx');
                
                if (xlsxBlob && xlsxBlob.size > 0) {
                    output += log(`âœ… XLSX æª”æ¡ˆç”ŸæˆæˆåŠŸï¼æª”æ¡ˆå¤§å°ï¼š${formatBytes(xlsxBlob.size)}`, 'success');
                    
                    // File signature check
                    const arrayBuffer = await xlsxBlob.slice(0, 4).arrayBuffer();
                    const signature = new Uint8Array(arrayBuffer);
                    const signatureHex = Array.from(signature).map(b => b.toString(16).padStart(2, '0')).join('');
                    
                    if (signatureHex === '504b0304') {
                        output += log('âœ… æª”æ¡ˆç°½åé©—è­‰é€šéï¼šé€™æ˜¯ä¸€å€‹çœŸæ­£çš„ ZIP/XLSX æª”æ¡ˆ', 'success');
                    } else {
                        output += log(`âš ï¸ æª”æ¡ˆç°½åç•°å¸¸ï¼š${signatureHex} (æ‡‰è©²æ˜¯ 504b0304)`, 'warning');
                    }
                    
                    output += createDownloadLink(xlsxBlob, 'test-spreadsheet.xlsx', 'XLSX æ¸¬è©¦æª”æ¡ˆ');
                    output += '<div class="info">ğŸ’¡ è«‹ä¸‹è¼‰å¾Œç”¨ Microsoft Excel æˆ– LibreOffice Calc é–‹å•Ÿé©—è­‰</div>';
                } else {
                    output += log('âŒ XLSX æª”æ¡ˆç”Ÿæˆå¤±æ•—ï¼šæª”æ¡ˆç‚ºç©º', 'error');
                }
                
            } catch (error) {
                output += log(`âŒ XLSX ç”ŸæˆéŒ¯èª¤ï¼š${error.message}`, 'error');
                console.error('XLSX æ¸¬è©¦éŒ¯èª¤:', error);
            }
            
            resultsDiv.innerHTML = output;
        }

        async function testComplexXlsx() {
            const resultsDiv = document.getElementById('xlsxResults');
            let output = '<h4>è¤‡é›œ XLSX æ ¼å¼æ¸¬è©¦</h4>';
            
            try {
                // Create more complex data with different data types
                const complexData = {
                    data: [
                        ['é …ç›®', 'æ•¸é‡', 'å–®åƒ¹', 'é‡‘é¡', 'æ—¥æœŸ', 'æ˜¯å¦å®Œæˆ'],
                        ['ç­†è¨˜æœ¬é›»è…¦', 5, 25000, '=B2*C2', '2024/8/31', 'TRUE'],
                        ['æ»‘é¼ ', 10, 800, '=B3*C3', '2024/8/30', 'TRUE'],
                        ['éµç›¤', 8, 1500, '=B4*C4', '2024/8/29', 'FALSE'],
                        ['è¢å¹•', 3, 12000, '=B5*C5', '2024/8/28', 'TRUE'],
                        ['å°è¡¨æ©Ÿ', 2, 8000, '=B6*C6', '2024/8/27', 'FALSE'],
                        ['', '', '', '', '', ''],
                        ['ç¸½è¨ˆ', '=SUM(B2:B6)', '', '=SUM(D2:D6)', '', ''],
                        ['å¹³å‡å–®åƒ¹', '', '=AVERAGE(C2:C6)', '', '', ''],
                        ['', '', '', '', '', ''],
                        ['çµ±è¨ˆå ±è¡¨', '', '', '', '', ''],
                        ['ç”Ÿæˆæ™‚é–“', new Date().toLocaleDateString(), '', '', '', ''],
                        ['ç¸½é …ç›®æ•¸', 5, '', '', '', '']
                    ],
                    sheets: [{ name: 'Sheet1', data: [] }],
                    fileName: 'complex-data',
                    rowCount: 13,
                    columnCount: 6
                };
                
                const xlsxBlob = await SpreadsheetConverter.convertToFormat(complexData, 'xlsx');
                
                if (xlsxBlob && xlsxBlob.size > 0) {
                    output += log(`âœ… è¤‡é›œ XLSX æª”æ¡ˆç”ŸæˆæˆåŠŸï¼æª”æ¡ˆå¤§å°ï¼š${formatBytes(xlsxBlob.size)}`, 'success');
                    output += createDownloadLink(xlsxBlob, 'complex-spreadsheet.xlsx', 'è¤‡é›œ XLSX æ¸¬è©¦æª”æ¡ˆ');
                } else {
                    output += log('âŒ è¤‡é›œ XLSX æª”æ¡ˆç”Ÿæˆå¤±æ•—', 'error');
                }
                
            } catch (error) {
                output += log(`âŒ è¤‡é›œ XLSX ç”ŸæˆéŒ¯èª¤ï¼š${error.message}`, 'error');
            }
            
            resultsDiv.innerHTML = output;
        }

        async function testPdfGeneration() {
            const resultsDiv = document.getElementById('pdfResults');
            let output = '<h4>PDF æ ¼å¼æ¸¬è©¦</h4>';
            
            try {
                output += log('é–‹å§‹ç”ŸæˆçœŸå¯¦ PDF æª”æ¡ˆ...', 'info');
                
                const testContent = {
                    title: 'PDF æ ¼å¼æ¸¬è©¦æ–‡ä»¶',
                    content: `é€™æ˜¯ä¸€å€‹æ¸¬è©¦ PDF æª”æ¡ˆçš„ç”ŸæˆåŠŸèƒ½ã€‚

æœ¬æª”æ¡ˆç”¨æ–¼é©—è­‰ä»¥ä¸‹åŠŸèƒ½ï¼š
â€¢ PDF æ ¼å¼çš„æ­£ç¢ºæ€§
â€¢ ä¸­æ–‡å­—ç¬¦çš„æ”¯æ´
â€¢ ç‰¹æ®Šç¬¦è™Ÿçš„é¡¯ç¤º
â€¢ å¤šè¡Œå…§å®¹çš„è™•ç†

æŠ€è¡“è³‡è¨Šï¼š
æª”æ¡ˆæ ¼å¼ï¼šPDF (Portable Document Format)
ç”Ÿæˆå·¥å…·ï¼šjsPDF
ç”Ÿæˆæ™‚é–“ï¼š${new Date().toLocaleString()}
æª”æ¡ˆç·¨ç¢¼ï¼šUTF-8

å…§å®¹æ¸¬è©¦ï¼š
æ•¸å­—ï¼š0123456789
è‹±æ–‡ï¼šABCDEFGHIJKLMNOPQRSTUVWXYZ
å°å¯«ï¼šabcdefghijklmnopqrstuvwxyz
ç‰¹æ®Šç¬¦è™Ÿï¼š!@#$%^&*()_+-=[]{}|;:'",./<>?

å¦‚æœæ‚¨èƒ½åœ¨ PDF é–±è®€å™¨ä¸­æ­£å¸¸é–‹å•Ÿä¸¦çœ‹åˆ°ä»¥ä¸Šæ‰€æœ‰å…§å®¹ï¼Œ
è¡¨ç¤º PDF è½‰æ›åŠŸèƒ½é‹ä½œæ­£å¸¸ã€‚

é€™æ˜¯ç”±ç¶²é ç‰ˆæª”æ¡ˆè½‰æ›å™¨ç”Ÿæˆçš„çœŸå¯¦ PDF æª”æ¡ˆã€‚`,
                    originalHtml: null
                };
                
                const pdfBlob = await DocumentConverter.convertToFormat(testContent, 'pdf');
                
                if (pdfBlob && pdfBlob.size > 0) {
                    output += log(`âœ… PDF æª”æ¡ˆç”ŸæˆæˆåŠŸï¼æª”æ¡ˆå¤§å°ï¼š${formatBytes(pdfBlob.size)}`, 'success');
                    
                    // PDF signature check
                    const arrayBuffer = await pdfBlob.slice(0, 8).arrayBuffer();
                    const signature = new Uint8Array(arrayBuffer);
                    const signatureString = new TextDecoder().decode(signature);
                    
                    if (signatureString.startsWith('%PDF-')) {
                        output += log('âœ… PDF æª”æ¡ˆç°½åé©—è­‰é€šéï¼šé€™æ˜¯ä¸€å€‹çœŸæ­£çš„ PDF æª”æ¡ˆ', 'success');
                    } else {
                        output += log(`âš ï¸ PDF æª”æ¡ˆç°½åç•°å¸¸ï¼š${signatureString} (æ‡‰è©²ä»¥ %PDF- é–‹é ­)`, 'warning');
                    }
                    
                    output += createDownloadLink(pdfBlob, 'test-document.pdf', 'PDF æ¸¬è©¦æª”æ¡ˆ');
                    output += '<div class="info">ğŸ’¡ è«‹ä¸‹è¼‰å¾Œç”¨ PDF é–±è®€å™¨é–‹å•Ÿé©—è­‰</div>';
                } else {
                    output += log('âŒ PDF æª”æ¡ˆç”Ÿæˆå¤±æ•—ï¼šæª”æ¡ˆç‚ºç©º', 'error');
                }
                
            } catch (error) {
                output += log(`âŒ PDF ç”ŸæˆéŒ¯èª¤ï¼š${error.message}`, 'error');
                console.error('PDF æ¸¬è©¦éŒ¯èª¤:', error);
            }
            
            resultsDiv.innerHTML = output;
        }

        async function testMultiPagePdf() {
            const resultsDiv = document.getElementById('pdfResults');
            let output = '<h4>å¤šé  PDF æ¸¬è©¦</h4>';
            
            try {
                const multiPageContent = {
                    title: 'å¤šé  PDF æ¸¬è©¦æ–‡ä»¶',
                    content: `ç¬¬ä¸€é å…§å®¹

é€™æ˜¯ä¸€å€‹å¤šé  PDF æª”æ¡ˆçš„æ¸¬è©¦ã€‚æœ¬æª”æ¡ˆåŒ…å«å¤šå€‹æ®µè½ï¼Œ
ç”¨æ–¼æ¸¬è©¦ PDF çš„åˆ†é åŠŸèƒ½ã€‚

ç¬¬ä¸€æ®µï¼šç°¡ä»‹
é€™å€‹æª”æ¡ˆæ˜¯ç‚ºäº†æ¸¬è©¦ PDF ç”Ÿæˆå™¨åœ¨è™•ç†é•·å…§å®¹æ™‚çš„åˆ†é èƒ½åŠ›ã€‚

ç¬¬äºŒæ®µï¼šå…§å®¹æ¸¬è©¦
Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat.

Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.

ç¬¬ä¸‰æ®µï¼šä¸­æ–‡å…§å®¹æ¸¬è©¦
åºŠå‰æ˜æœˆå…‰ï¼Œç–‘æ˜¯åœ°ä¸Šéœœã€‚èˆ‰é ­æœ›æ˜æœˆï¼Œä½é ­æ€æ•…é„‰ã€‚
æ˜¥çœ ä¸è¦ºæ›‰ï¼Œè™•è™•èå•¼é³¥ã€‚å¤œä¾†é¢¨é›¨è²ï¼ŒèŠ±è½çŸ¥å¤šå°‘ã€‚
ç™½æ—¥ä¾å±±ç›¡ï¼Œé»ƒæ²³å…¥æµ·æµã€‚æ¬²çª®åƒé‡Œç›®ï¼Œæ›´ä¸Šä¸€å±¤æ¨“ã€‚

ç¬¬å››æ®µï¼šæŠ€è¡“è³‡è¨Š
æª”æ¡ˆæ ¼å¼ï¼šPDF
ç”Ÿæˆå·¥å…·ï¼šjsPDF
é é¢å¤§å°ï¼šA4
å­—é«”ï¼šHelvetica
ç·¨ç¢¼ï¼šUTF-8

ç¬¬äº”æ®µï¼šæ›´å¤šæ¸¬è©¦å…§å®¹
é€™è£¡æ”¾ç½®æ›´å¤šå…§å®¹ä»¥ç¢ºä¿PDFèƒ½æ­£ç¢ºåˆ†é ã€‚æ¯ä¸€æ®µéƒ½æ˜¯ç‚ºäº†æ¸¬è©¦ä¸åŒçš„åŠŸèƒ½å’Œç¢ºä¿å…§å®¹èƒ½å¤ æ­£ç¢ºé¡¯ç¤ºåœ¨å¤šå€‹é é¢ä¸Šã€‚

ç¬¬å…­æ®µï¼šæ•¸æ“šæ¸¬è©¦
é …ç›®ä¸€ï¼šæ¸¬è©¦è³‡æ–™ A
é …ç›®äºŒï¼šæ¸¬è©¦è³‡æ–™ B  
é …ç›®ä¸‰ï¼šæ¸¬è©¦è³‡æ–™ C
é …ç›®å››ï¼šæ¸¬è©¦è³‡æ–™ D
é …ç›®äº”ï¼šæ¸¬è©¦è³‡æ–™ E

ç¬¬ä¸ƒæ®µï¼šçµè«–
å¦‚æœæ‚¨èƒ½çœ‹åˆ°å¤šå€‹é é¢ä¸¦ä¸”å…§å®¹é¡¯ç¤ºæ­£å¸¸ï¼Œ
è¡¨ç¤ºå¤šé  PDF ç”ŸæˆåŠŸèƒ½é‹ä½œæ­£å¸¸ã€‚

ç”Ÿæˆæ™‚é–“ï¼š${new Date().toLocaleString()}
æª”æ¡ˆç‰ˆæœ¬ï¼š2.0`,
                    originalHtml: null
                };
                
                const pdfBlob = await DocumentConverter.convertToFormat(multiPageContent, 'pdf');
                
                if (pdfBlob && pdfBlob.size > 0) {
                    output += log(`âœ… å¤šé  PDF æª”æ¡ˆç”ŸæˆæˆåŠŸï¼æª”æ¡ˆå¤§å°ï¼š${formatBytes(pdfBlob.size)}`, 'success');
                    output += createDownloadLink(pdfBlob, 'multipage-test.pdf', 'å¤šé  PDF æ¸¬è©¦æª”æ¡ˆ');
                } else {
                    output += log('âŒ å¤šé  PDF æª”æ¡ˆç”Ÿæˆå¤±æ•—', 'error');
                }
                
            } catch (error) {
                output += log(`âŒ å¤šé  PDF ç”ŸæˆéŒ¯èª¤ï¼š${error.message}`, 'error');
            }
            
            resultsDiv.innerHTML = output;
        }

        // Auto-initialize
        window.addEventListener('load', function() {
            setTimeout(() => {
                checkLibraries();
            }, 2000);
        });
    </script>
</body>
</html>