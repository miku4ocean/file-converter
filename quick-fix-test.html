<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <title>å¿«é€Ÿä¿®å¾©æ¸¬è©¦</title>
</head>
<body>
    <h1>ğŸ”§ å¿«é€Ÿä¿®å¾©é©—è­‰</h1>
    <div id="results"></div>

    <script src="assets/js/converters/document.js"></script>
    <script src="assets/js/converters/presentation.js"></script>
    <script src="assets/js/converters/spreadsheet.js"></script>

    <script>
        function log(message, type = 'info') {
            const div = document.createElement('div');
            div.style.margin = '10px 0';
            div.style.padding = '10px';
            div.style.borderRadius = '5px';
            div.style.background = type === 'success' ? '#d4edda' : type === 'error' ? '#f8d7da' : '#d1ecf1';
            div.style.color = type === 'success' ? '#155724' : type === 'error' ? '#721c24' : '#0c5460';
            div.innerHTML = `${type === 'success' ? 'âœ…' : type === 'error' ? 'âŒ' : 'â„¹ï¸'} ${message}`;
            document.getElementById('results').appendChild(div);
        }

        // æ¸¬è©¦è½‰æ›å™¨è¼‰å…¥
        setTimeout(() => {
            log('é–‹å§‹è½‰æ›å™¨è¼‰å…¥æ¸¬è©¦...');

            // 1. æ¸¬è©¦ DocumentConverter
            if (typeof DocumentConverter !== 'undefined') {
                log('DocumentConverter è¼‰å…¥æˆåŠŸ');
                
                // æ¸¬è©¦ PDF è½‰æ›æ–¹æ³•
                if (typeof DocumentConverter.convertToPdf === 'function') {
                    log('PDF è½‰æ›æ–¹æ³•å¯ç”¨', 'success');
                } else {
                    log('PDF è½‰æ›æ–¹æ³•ä¸å¯ç”¨', 'error');
                }
            } else {
                log('DocumentConverter è¼‰å…¥å¤±æ•—', 'error');
            }

            // 2. æ¸¬è©¦ PresentationConverter  
            if (typeof PresentationConverter !== 'undefined') {
                log('PresentationConverter è¼‰å…¥æˆåŠŸ', 'success');
                
                // æ¸¬è©¦é—œéµæ–¹æ³•
                if (typeof PresentationConverter.isValidPresentationFile === 'function') {
                    log('ç°¡å ±æª”æ¡ˆé©—è­‰æ–¹æ³•å¯ç”¨', 'success');
                } else {
                    log('ç°¡å ±æª”æ¡ˆé©—è­‰æ–¹æ³•ä¸å¯ç”¨', 'error');
                }
            } else {
                log('PresentationConverter è¼‰å…¥å¤±æ•—', 'error');
            }

            // 3. æ¸¬è©¦ SpreadsheetConverter
            if (typeof SpreadsheetConverter !== 'undefined') {
                log('SpreadsheetConverter è¼‰å…¥æˆåŠŸ', 'success');
            } else {
                log('SpreadsheetConverter è¼‰å…¥å¤±æ•—', 'error');
            }

            // 4. æ¸¬è©¦ PDF è½‰æ›åŠŸèƒ½
            testPDFConversion();

        }, 500);

        async function testPDFConversion() {
            try {
                log('é–‹å§‹æ¸¬è©¦ PDF è½‰æ›åŠŸèƒ½...');
                
                if (!DocumentConverter || typeof DocumentConverter.convertToPdf !== 'function') {
                    log('PDF è½‰æ›åŠŸèƒ½ä¸å¯ç”¨', 'error');
                    return;
                }

                const testContent = "å¿«é€Ÿä¿®å¾©æ¸¬è©¦\n\né€™æ˜¯ä¸€å€‹æ¸¬è©¦æ–‡ä»¶ã€‚\nåŒ…å«ä¸­æ–‡å­—ç¬¦ã€‚";
                const pdfBlob = await DocumentConverter.convertToPdf(testContent, 'æ¸¬è©¦æ–‡ä»¶');
                
                if (pdfBlob && pdfBlob.size > 0) {
                    log(`PDF è½‰æ›æˆåŠŸï¼æª”æ¡ˆå¤§å°: ${pdfBlob.size} bytes`, 'success');
                    
                    // è‡ªå‹•ä¸‹è¼‰
                    const url = URL.createObjectURL(pdfBlob);
                    const a = document.createElement('a');
                    a.href = url;
                    a.download = 'quick-test.pdf';
                    a.click();
                    setTimeout(() => URL.revokeObjectURL(url), 1000);
                    
                    log('PDF å·²è‡ªå‹•ä¸‹è¼‰', 'success');
                } else {
                    log('PDF è½‰æ›å¤±æ•—ï¼šç”¢ç”Ÿç©ºæª”æ¡ˆ', 'error');
                }

            } catch (error) {
                log(`PDF è½‰æ›éŒ¯èª¤: ${error.message}`, 'error');
                console.error('è©³ç´°éŒ¯èª¤:', error);
            }
        }
    </script>
</body>
</html>