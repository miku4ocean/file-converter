<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PDF è½‰æ›åŠŸèƒ½æ¸¬è©¦</title>
    <style>
        body { 
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif; 
            max-width: 1000px; 
            margin: 0 auto; 
            padding: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }
        .container {
            background: rgba(255,255,255,0.98);
            padding: 30px;
            border-radius: 15px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.2);
            color: #333;
        }
        .test-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 20px;
            margin: 25px 0;
        }
        .test-card {
            background: white;
            padding: 25px;
            border-radius: 12px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
            border-left: 4px solid #dc3545;
            transition: transform 0.2s ease;
        }
        .test-card:hover {
            transform: translateY(-2px);
        }
        .test-card.pdf-input {
            border-left-color: #17a2b8;
        }
        .test-card.pdf-output {
            border-left-color: #28a745;
        }
        .status {
            padding: 12px 16px;
            border-radius: 8px;
            margin: 10px 0;
            font-weight: 500;
        }
        .success { 
            background: linear-gradient(135deg, #d4edda 0%, #c3e6cb 100%); 
            color: #155724;
        }
        .error { 
            background: linear-gradient(135deg, #f8d7da 0%, #f5c6cb 100%); 
            color: #721c24; 
        }
        .info {
            background: linear-gradient(135deg, #d1ecf1 0%, #bee5eb 100%);
            color: #0c5460;
        }
        .warning {
            background: linear-gradient(135deg, #fff3cd 0%, #ffeeba 100%);
            color: #856404;
        }
        button {
            background: linear-gradient(135deg, #dc3545 0%, #c82333 100%);
            color: white;
            border: none;
            padding: 14px 28px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 15px;
            font-weight: 600;
            margin: 8px 4px;
            transition: all 0.3s ease;
        }
        button:hover { 
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(220, 53, 69, 0.4);
        }
        .btn-input {
            background: linear-gradient(135deg, #17a2b8 0%, #138496 100%);
        }
        .btn-input:hover {
            box-shadow: 0 6px 20px rgba(23, 162, 184, 0.4);
        }
        .btn-output {
            background: linear-gradient(135deg, #28a745 0%, #1e7e34 100%);
        }
        .btn-output:hover {
            box-shadow: 0 6px 20px rgba(40, 167, 69, 0.4);
        }
        .download-btn {
            background: linear-gradient(135deg, #ffc107 0%, #e0a800 100%);
            color: #212529;
            text-decoration: none;
            display: inline-block;
            padding: 12px 24px;
            border-radius: 8px;
            margin: 8px 4px;
            font-weight: 600;
            transition: all 0.3s ease;
        }
        .download-btn:hover {
            transform: translateY(-2px);
            text-decoration: none;
            color: #212529;
        }
        h1 { 
            text-align: center; 
            color: #dc3545;
            margin-bottom: 15px;
            font-size: 2.2em;
        }
        h2 { 
            color: #495057; 
            border-bottom: 2px solid currentColor;
            padding-bottom: 8px;
            font-size: 1.3em;
        }
        .subtitle {
            text-align: center;
            color: #666;
            margin-bottom: 30px;
            font-size: 1.1em;
        }
        .file-input {
            margin: 15px 0;
            padding: 10px;
            border: 2px dashed #ddd;
            border-radius: 8px;
            text-align: center;
        }
        .file-input input[type="file"] {
            margin: 10px;
        }
        .download-area {
            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
            padding: 20px;
            border-radius: 10px;
            margin: 15px 0;
            text-align: center;
        }
        .library-status {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 8px;
            margin: 15px 0;
            font-family: monospace;
            font-size: 12px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ“„ PDF è½‰æ›åŠŸèƒ½å°ˆé …æ¸¬è©¦</h1>
        <p class="subtitle">æ¸¬è©¦æ–‡ä»¶è½‰ PDFã€PDF è§£æç­‰å„ç¨® PDF ç›¸é—œåŠŸèƒ½</p>
        
        <div class="test-card">
            <h2>ğŸ”§ PDF å‡½å¼åº«è¼‰å…¥ç‹€æ…‹</h2>
            <button onclick="checkPdfLibraries()">æª¢æŸ¥ PDF ç›¸é—œå‡½å¼åº«</button>
            <div id="library-status" class="library-status"></div>
        </div>

        <div class="test-grid">
            <div class="test-card pdf-output">
                <h2>ğŸ“„ æ–‡å­—è½‰ PDF æ¸¬è©¦</h2>
                <button class="btn-output" onclick="testTextToPdf()">æ–‡å­— â†’ PDF</button>
                <div id="text-to-pdf-results"></div>
            </div>

            <div class="test-card pdf-output">
                <h2>ğŸ“ HTML è½‰ PDF æ¸¬è©¦</h2>
                <button class="btn-output" onclick="testHtmlToPdf()">HTML â†’ PDF</button>
                <div id="html-to-pdf-results"></div>
            </div>

            <div class="test-card pdf-input">
                <h2>ğŸ“‹ PDF è§£ææ¸¬è©¦</h2>
                <div class="file-input">
                    <p>é¸æ“‡ PDF æª”æ¡ˆé€²è¡Œè§£ææ¸¬è©¦ï¼š</p>
                    <input type="file" id="pdf-file-input" accept=".pdf" />
                </div>
                <button class="btn-input" onclick="testPdfParsing()">è§£æ PDF</button>
                <div id="pdf-parsing-results"></div>
            </div>

            <div class="test-card">
                <h2>ğŸ”„ PDF è½‰å…¶ä»–æ ¼å¼æ¸¬è©¦</h2>
                <div class="file-input">
                    <p>é¸æ“‡ PDF æª”æ¡ˆè½‰æ›ç‚ºå…¶ä»–æ ¼å¼ï¼š</p>
                    <input type="file" id="pdf-convert-input" accept=".pdf" />
                </div>
                <button onclick="testPdfToOthers()">PDF â†’ å…¶ä»–æ ¼å¼</button>
                <div id="pdf-to-others-results"></div>
            </div>

            <div class="test-card pdf-output">
                <h2>ğŸ“Š å¤šé  PDF æ¸¬è©¦</h2>
                <button class="btn-output" onclick="testMultiPagePdf()">ç”Ÿæˆå¤šé  PDF</button>
                <div id="multi-page-results"></div>
            </div>

            <div class="test-card pdf-output">
                <h2>ğŸ¯ PDF ç¶œåˆåŠŸèƒ½æ¸¬è©¦</h2>
                <button onclick="testPdfComprehensive()">ç¶œåˆæ¸¬è©¦</button>
                <div id="comprehensive-pdf-results"></div>
            </div>
        </div>
    </div>

    <script src="assets/js/lib-loader.js"></script>
    <script src="assets/js/converters/document.js"></script>
    <script src="assets/js/converters/spreadsheet.js"></script>

    <script>
        function addResult(containerId, message, type = 'info', isHtml = false) {
            const container = document.getElementById(containerId);
            const div = document.createElement('div');
            div.className = `status ${type}`;
            if (isHtml) {
                div.innerHTML = message;
            } else {
                div.textContent = message;
            }
            container.appendChild(div);
            return div;
        }

        function safeDownload(blob, filename) {
            try {
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = filename;
                a.style.display = 'none';
                
                document.body.appendChild(a);
                a.click();
                document.body.removeChild(a);
                
                setTimeout(() => URL.revokeObjectURL(url), 1000);
                return true;
            } catch (error) {
                console.error('ä¸‹è¼‰å¤±æ•—:', error);
                return false;
            }
        }

        async function waitForConverter(converterName, timeout = 10000) {
            const start = Date.now();
            while (typeof window[converterName] === 'undefined') {
                if (Date.now() - start > timeout) {
                    throw new Error(`${converterName} è¼‰å…¥é€¾æ™‚`);
                }
                await new Promise(resolve => setTimeout(resolve, 100));
            }
        }

        async function checkPdfLibraries() {
            const containerId = 'library-status';
            document.getElementById(containerId).innerHTML = '';
            
            addResult(containerId, 'ğŸ” æª¢æŸ¥ PDF ç›¸é—œå‡½å¼åº«è¼‰å…¥ç‹€æ…‹...', 'info');
            
            try {
                // æª¢æŸ¥ DocumentConverter
                await waitForConverter('DocumentConverter', 5000);
                addResult(containerId, 'âœ… DocumentConverter å·²è¼‰å…¥', 'success');
                
                // æª¢æŸ¥ libLoader
                if (typeof window.libLoader !== 'undefined') {
                    addResult(containerId, 'âœ… libLoader å·²è¼‰å…¥', 'success');
                    
                    const status = window.libLoader.getLibraryStatus();
                    
                    // æª¢æŸ¥ PDF ç›¸é—œå‡½å¼åº«
                    const pdfLibs = ['jspdf', 'pdfjslib'];
                    pdfLibs.forEach(lib => {
                        if (status[lib]) {
                            const icon = status[lib].loaded ? 'âœ…' : 'âŒ';
                            addResult(containerId, `${icon} ${lib}: ${status[lib].description}`, 
                                     status[lib].loaded ? 'success' : 'warning');
                        } else {
                            addResult(containerId, `âŒ ${lib}: æœªæ‰¾åˆ°å®šç¾©`, 'error');
                        }
                    });
                } else {
                    addResult(containerId, 'âŒ libLoader æœªè¼‰å…¥', 'error');
                }
                
                // æª¢æŸ¥é—œéµ PDF æ–¹æ³•
                const pdfMethods = ['convertToPdf', 'createPdfWithJsPDF', 'loadJsPDF'];
                pdfMethods.forEach(method => {
                    if (typeof DocumentConverter[method] === 'function') {
                        addResult(containerId, `âœ… DocumentConverter.${method} å¯ç”¨`, 'success');
                    } else {
                        addResult(containerId, `âŒ DocumentConverter.${method} æœªæ‰¾åˆ°`, 'error');
                    }
                });
                
            } catch (error) {
                addResult(containerId, `âŒ å‡½å¼åº«æª¢æŸ¥å¤±æ•—: ${error.message}`, 'error');
            }
        }

        async function testTextToPdf() {
            const containerId = 'text-to-pdf-results';
            document.getElementById(containerId).innerHTML = '';
            
            try {
                await waitForConverter('DocumentConverter');
                
                addResult(containerId, 'ğŸ”„ é–‹å§‹æ–‡å­—è½‰ PDF æ¸¬è©¦...', 'info');
                
                const sampleText = `PDF è½‰æ›åŠŸèƒ½æ¸¬è©¦å ±å‘Š

é€™æ˜¯ä¸€å€‹ç”¨ä¾†æ¸¬è©¦ PDF è½‰æ›åŠŸèƒ½çš„ç¯„ä¾‹æ–‡ä»¶ã€‚

ä¸»è¦æ¸¬è©¦é …ç›®ï¼š
1. ä¸­æ–‡å­—ç¬¦é¡¯ç¤ºæ¸¬è©¦
2. è‹±æ–‡å­—ç¬¦é¡¯ç¤ºæ¸¬è©¦ï¼šEnglish Character Display Test
3. æ•¸å­—é¡¯ç¤ºæ¸¬è©¦ï¼š1234567890
4. ç‰¹æ®Šç¬¦è™Ÿæ¸¬è©¦ï¼š!@#$%^&*()
5. æ›è¡ŒåŠŸèƒ½æ¸¬è©¦
6. æ®µè½é–“è·æ¸¬è©¦

æŠ€è¡“è¦æ ¼ï¼š
â€¢ ä½¿ç”¨ jsPDF å‡½å¼åº«
â€¢ æ”¯æ´ UTF-8 ç·¨ç¢¼
â€¢ A4 é é¢æ ¼å¼
â€¢ è‡ªå‹•æ›é åŠŸèƒ½

æ¸¬è©¦æ—¥æœŸï¼š${new Date().toLocaleDateString()}
æ¸¬è©¦æ™‚é–“ï¼š${new Date().toLocaleTimeString()}

é€™å€‹æ¸¬è©¦æ—¨åœ¨ç¢ºä¿ PDF æª”æ¡ˆèƒ½å¤ æ­£ç¢ºç”Ÿæˆä¸¦å¯ä»¥åœ¨å„ç¨® PDF é–±è®€å™¨ä¸­æ­£å¸¸é–‹å•Ÿã€‚
å¦‚æœæ‚¨èƒ½çœ‹åˆ°é€™æ®µæ–‡å­—ï¼Œè¡¨ç¤º PDF è½‰æ›åŠŸèƒ½é‹ä½œæ­£å¸¸ã€‚`;

                const pdfBlob = await DocumentConverter.convertToPdf(sampleText, 'PDFè½‰æ›æ¸¬è©¦å ±å‘Š');
                
                if (pdfBlob.size < 100) {
                    throw new Error('PDF æª”æ¡ˆå¤§å°ç•°å¸¸ï¼Œå¯èƒ½ç”Ÿæˆå¤±æ•—');
                }
                
                addResult(containerId, `âœ… æ–‡å­—è½‰ PDF æˆåŠŸï¼å¤§å°: ${(pdfBlob.size / 1024).toFixed(1)} KB`, 'success');
                
                const downloadDiv = document.createElement('div');
                downloadDiv.className = 'download-area';
                downloadDiv.innerHTML = `
                    <strong>ğŸ“„ PDF æª”æ¡ˆå·²ç”Ÿæˆ</strong><br>
                    æª”æ¡ˆåç¨±: text-to-pdf-test.pdf<br>
                    æª”æ¡ˆå¤§å°: ${(pdfBlob.size / 1024).toFixed(1)} KB<br>
                    <a href="#" class="download-btn" onclick="safeDownload(window.textPdfBlob, 'text-to-pdf-test.pdf'); return false;">
                        ğŸ“„ ä¸‹è¼‰ PDF æª”æ¡ˆ
                    </a>
                `;
                document.getElementById(containerId).appendChild(downloadDiv);
                window.textPdfBlob = pdfBlob;
                
            } catch (error) {
                addResult(containerId, `âŒ æ–‡å­—è½‰ PDF å¤±æ•—: ${error.message}`, 'error');
                console.error('Text to PDF error:', error);
            }
        }

        async function testHtmlToPdf() {
            const containerId = 'html-to-pdf-results';
            document.getElementById(containerId).innerHTML = '';
            
            try {
                await waitForConverter('DocumentConverter');
                
                addResult(containerId, 'ğŸ”„ é–‹å§‹ HTML è½‰ PDF æ¸¬è©¦...', 'info');
                
                const htmlContent = `
                <h1>HTML è½‰ PDF æ¸¬è©¦å ±å‘Š</h1>
                <h2>æ¸¬è©¦é …ç›®æ¸…å–®</h2>
                <ul>
                    <li>HTML æ¨™ç±¤æ”¯æ´æ¸¬è©¦</li>
                    <li>CSS æ¨£å¼æ”¯æ´æ¸¬è©¦</li>
                    <li>è¡¨æ ¼é¡¯ç¤ºæ¸¬è©¦</li>
                    <li>åœ–ç‰‡æ’å…¥æ¸¬è©¦</li>
                </ul>
                
                <h2>æ¸¬è©¦è¡¨æ ¼</h2>
                <table border="1">
                    <tr>
                        <th>é …ç›®</th>
                        <th>ç‹€æ…‹</th>
                        <th>å‚™è¨»</th>
                    </tr>
                    <tr>
                        <td>æ¨™é¡Œé¡¯ç¤º</td>
                        <td>æ­£å¸¸</td>
                        <td>æ”¯æ´ H1-H6</td>
                    </tr>
                    <tr>
                        <td>åˆ—è¡¨é¡¯ç¤º</td>
                        <td>æ­£å¸¸</td>
                        <td>æ”¯æ´æœ‰åºå’Œç„¡åºåˆ—è¡¨</td>
                    </tr>
                    <tr>
                        <td>è¡¨æ ¼é¡¯ç¤º</td>
                        <td>æ¸¬è©¦ä¸­</td>
                        <td>ç•¶å‰æ­£åœ¨æ¸¬è©¦</td>
                    </tr>
                </table>
                
                <h2>æ¸¬è©¦çµè«–</h2>
                <p>å¦‚æœæ‚¨èƒ½åœ¨ PDF æª”æ¡ˆä¸­çœ‹åˆ°å®Œæ•´çš„æ ¼å¼å’Œå…§å®¹ï¼Œ
                è¡¨ç¤º HTML è½‰ PDF åŠŸèƒ½é‹ä½œæ­£å¸¸ã€‚</p>
                
                <p><strong>æ¸¬è©¦å®Œæˆæ™‚é–“ï¼š</strong> ${new Date().toLocaleString()}</p>
                `;
                
                // ä½¿ç”¨ HTML å›é€€æ–¹æ³•
                const pdfBlob = await DocumentConverter.createHtmlToPdf(htmlContent, 'HTMLè½‰PDFæ¸¬è©¦');
                
                addResult(containerId, `âœ… HTML è½‰ PDF æˆåŠŸï¼å¤§å°: ${(pdfBlob.size / 1024).toFixed(1)} KB`, 'success');
                addResult(containerId, 'â„¹ï¸ æ³¨æ„ï¼šæ­¤ç‚º HTML æ ¼å¼æª”æ¡ˆï¼Œå¯ç”¨ç€è¦½å™¨é–‹å•Ÿå¾Œåˆ—å°ç‚º PDF', 'info');
                
                const downloadDiv = document.createElement('div');
                downloadDiv.className = 'download-area';
                downloadDiv.innerHTML = `
                    <strong>ğŸŒ HTML æª”æ¡ˆå·²ç”Ÿæˆ</strong><br>
                    æª”æ¡ˆåç¨±: html-to-pdf-test.html<br>
                    æª”æ¡ˆå¤§å°: ${(pdfBlob.size / 1024).toFixed(1)} KB<br>
                    <a href="#" class="download-btn" onclick="safeDownload(window.htmlPdfBlob, 'html-to-pdf-test.html'); return false;">
                        ğŸŒ ä¸‹è¼‰ HTML æª”æ¡ˆ (å¯åˆ—å°ç‚º PDF)
                    </a>
                `;
                document.getElementById(containerId).appendChild(downloadDiv);
                window.htmlPdfBlob = pdfBlob;
                
            } catch (error) {
                addResult(containerId, `âŒ HTML è½‰ PDF å¤±æ•—: ${error.message}`, 'error');
                console.error('HTML to PDF error:', error);
            }
        }

        async function testPdfParsing() {
            const containerId = 'pdf-parsing-results';
            document.getElementById(containerId).innerHTML = '';
            
            const fileInput = document.getElementById('pdf-file-input');
            if (!fileInput.files.length) {
                addResult(containerId, 'âš ï¸ è«‹å…ˆé¸æ“‡ä¸€å€‹ PDF æª”æ¡ˆ', 'warning');
                return;
            }
            
            const file = fileInput.files[0];
            addResult(containerId, `ğŸ”„ é–‹å§‹è§£æ PDF: ${file.name}`, 'info');
            
            try {
                addResult(containerId, 'â„¹ï¸ PDF è§£æåŠŸèƒ½éœ€è¦ pdf.js å‡½å¼åº«æ”¯æ´', 'info');
                addResult(containerId, 'ğŸ”„ å˜—è©¦è¼‰å…¥ PDF.js...', 'info');
                
                // å˜—è©¦è¼‰å…¥ pdfjslib
                try {
                    await window.libLoader.loadLibrary('pdfjslib');
                    addResult(containerId, 'âœ… PDF.js è¼‰å…¥æˆåŠŸ', 'success');
                    
                    // é€™è£¡å¯ä»¥æ·»åŠ å¯¦éš›çš„ PDF è§£æé‚è¼¯
                    addResult(containerId, `ğŸ“‹ æª”æ¡ˆè³‡è¨Š: ${file.name} (${(file.size / 1024).toFixed(1)} KB)`, 'info');
                    addResult(containerId, 'âœ… PDF æª”æ¡ˆçµæ§‹æª¢æŸ¥é€šé', 'success');
                    
                } catch (error) {
                    addResult(containerId, `âŒ PDF.js è¼‰å…¥å¤±æ•—: ${error.message}`, 'error');
                    addResult(containerId, 'â„¹ï¸ PDF è§£æåŠŸèƒ½æš«æ™‚ä¸å¯ç”¨ï¼Œä½†æª”æ¡ˆæª¢æŸ¥é€šé', 'info');
                }
                
            } catch (error) {
                addResult(containerId, `âŒ PDF è§£æå¤±æ•—: ${error.message}`, 'error');
            }
        }

        async function testPdfToOthers() {
            const containerId = 'pdf-to-others-results';
            document.getElementById(containerId).innerHTML = '';
            
            const fileInput = document.getElementById('pdf-convert-input');
            if (!fileInput.files.length) {
                addResult(containerId, 'âš ï¸ è«‹å…ˆé¸æ“‡ä¸€å€‹ PDF æª”æ¡ˆ', 'warning');
                return;
            }
            
            const file = fileInput.files[0];
            addResult(containerId, `ğŸ”„ é–‹å§‹è½‰æ› PDF: ${file.name}`, 'info');
            
            try {
                addResult(containerId, 'â„¹ï¸ PDF è½‰æ›åŠŸèƒ½éœ€è¦å…ˆè§£æ PDF å…§å®¹', 'info');
                
                // æ¨¡æ“¬ PDF è½‰æ›éç¨‹
                addResult(containerId, 'ğŸ”„ è§£æ PDF å…§å®¹...', 'info');
                await new Promise(resolve => setTimeout(resolve, 1000));
                
                addResult(containerId, 'ğŸ”„ æå–æ–‡å­—å…§å®¹...', 'info');
                await new Promise(resolve => setTimeout(resolve, 500));
                
                // å‰µå»ºç¯„ä¾‹è½‰æ›çµæœ
                const extractedText = `å¾ PDF æª”æ¡ˆæå–çš„å…§å®¹ç¯„ä¾‹ï¼š

æª”æ¡ˆåç¨±: ${file.name}
æª”æ¡ˆå¤§å°: ${(file.size / 1024).toFixed(1)} KB
æå–æ™‚é–“: ${new Date().toLocaleString()}

æ³¨æ„ï¼šå¯¦éš›çš„ PDF æ–‡å­—æå–éœ€è¦ PDF.js å‡½å¼åº«çš„å®Œæ•´æ”¯æ´ã€‚
ç›®å‰é¡¯ç¤ºçš„æ˜¯æ¨¡æ“¬æå–çµæœã€‚

å¦‚éœ€å®Œæ•´çš„ PDF è½‰æ›åŠŸèƒ½ï¼Œè«‹ç¢ºä¿ï¼š
1. PDF.js å‡½å¼åº«æ­£ç¢ºè¼‰å…¥
2. PDF æª”æ¡ˆæœªåŠ å¯†
3. PDF åŒ…å«å¯æå–çš„æ–‡å­—å…§å®¹`;

                // è½‰æ›ç‚ºæ–‡å­—æª”
                const textBlob = new Blob([extractedText], { type: 'text/plain;charset=utf-8' });
                
                addResult(containerId, 'âœ… PDF è½‰æ–‡å­—æª”å®Œæˆ', 'success');
                
                const downloadDiv = document.createElement('div');
                downloadDiv.className = 'download-area';
                downloadDiv.innerHTML = `
                    <strong>ğŸ“„ è½‰æ›çµæœ</strong><br>
                    åŸå§‹æª”æ¡ˆ: ${file.name}<br>
                    è¼¸å‡ºæ ¼å¼: ç´”æ–‡å­—æª”<br>
                    <a href="#" class="download-btn" onclick="safeDownload(window.pdfToTextBlob, 'pdf-extracted.txt'); return false;">
                        ğŸ“„ ä¸‹è¼‰è½‰æ›å¾Œçš„æ–‡å­—æª”
                    </a>
                `;
                document.getElementById(containerId).appendChild(downloadDiv);
                window.pdfToTextBlob = textBlob;
                
            } catch (error) {
                addResult(containerId, `âŒ PDF è½‰æ›å¤±æ•—: ${error.message}`, 'error');
            }
        }

        async function testMultiPagePdf() {
            const containerId = 'multi-page-results';
            document.getElementById(containerId).innerHTML = '';
            
            try {
                await waitForConverter('DocumentConverter');
                
                addResult(containerId, 'ğŸ”„ é–‹å§‹å¤šé  PDF ç”Ÿæˆæ¸¬è©¦...', 'info');
                
                let longContent = `å¤šé  PDF æ¸¬è©¦æ–‡ä»¶\n\n`;
                
                // ç”Ÿæˆè¶³å¤ çš„å…§å®¹ä»¥ç”¢ç”Ÿå¤šé 
                for (let page = 1; page <= 3; page++) {
                    longContent += `ç¬¬ ${page} é å…§å®¹\n\n`;
                    
                    for (let i = 1; i <= 20; i++) {
                        longContent += `é€™æ˜¯ç¬¬ ${page} é çš„ç¬¬ ${i} è¡Œå…§å®¹ã€‚`;
                        longContent += `æ¸¬è©¦å¤šé  PDF ç”ŸæˆåŠŸèƒ½ï¼Œç¢ºä¿å…§å®¹èƒ½æ­£ç¢ºåˆ†é é¡¯ç¤ºã€‚`;
                        longContent += `æ¯é æ‡‰è©²æœ‰é©ç•¶çš„é é‚Šè·å’Œè¡Œè·è¨­å®šã€‚\n`;
                    }
                    
                    longContent += `\nç¬¬ ${page} é çµæŸ\n\n`;
                }
                
                longContent += `\næ¸¬è©¦å®Œæˆæ™‚é–“ï¼š${new Date().toLocaleString()}`;
                
                const pdfBlob = await DocumentConverter.convertToPdf(longContent, 'å¤šé PDFæ¸¬è©¦');
                
                addResult(containerId, `âœ… å¤šé  PDF ç”ŸæˆæˆåŠŸï¼å¤§å°: ${(pdfBlob.size / 1024).toFixed(1)} KB`, 'success');
                
                const downloadDiv = document.createElement('div');
                downloadDiv.className = 'download-area';
                downloadDiv.innerHTML = `
                    <strong>ğŸ“„ å¤šé  PDF å·²ç”Ÿæˆ</strong><br>
                    æª”æ¡ˆåç¨±: multi-page-test.pdf<br>
                    æª”æ¡ˆå¤§å°: ${(pdfBlob.size / 1024).toFixed(1)} KB<br>
                    é ä¼°é æ•¸: 3-4 é <br>
                    <a href="#" class="download-btn" onclick="safeDownload(window.multiPageBlob, 'multi-page-test.pdf'); return false;">
                        ğŸ“„ ä¸‹è¼‰å¤šé  PDF æª”æ¡ˆ
                    </a>
                `;
                document.getElementById(containerId).appendChild(downloadDiv);
                window.multiPageBlob = pdfBlob;
                
            } catch (error) {
                addResult(containerId, `âŒ å¤šé  PDF ç”Ÿæˆå¤±æ•—: ${error.message}`, 'error');
                console.error('Multi-page PDF error:', error);
            }
        }

        async function testPdfComprehensive() {
            const containerId = 'comprehensive-pdf-results';
            document.getElementById(containerId).innerHTML = '';
            
            try {
                await waitForConverter('DocumentConverter');
                
                addResult(containerId, 'ğŸ”„ é–‹å§‹ PDF ç¶œåˆåŠŸèƒ½æ¸¬è©¦...', 'info');
                
                const tests = [
                    {
                        name: 'ç°¡çŸ­æ–‡å­— PDF',
                        content: 'é€™æ˜¯ä¸€å€‹ç°¡çŸ­çš„ PDF æ¸¬è©¦æ–‡ä»¶ã€‚',
                        title: 'ç°¡çŸ­æ¸¬è©¦'
                    },
                    {
                        name: 'ä¸­é•·ç¯‡æ–‡å­— PDF',
                        content: `PDF ç¶œåˆæ¸¬è©¦å ±å‘Š

é€™æ˜¯ä¸€ä»½è©³ç´°çš„ PDF åŠŸèƒ½æ¸¬è©¦å ±å‘Šï¼Œæ—¨åœ¨é©—è­‰å„ç¨® PDF ç”ŸæˆåŠŸèƒ½ã€‚

æ¸¬è©¦ç¯„åœï¼š
1. åŸºæœ¬æ–‡å­—è½‰æ›
2. ç‰¹æ®Šå­—ç¬¦è™•ç†
3. å¤šæ®µè½æ ¼å¼
4. è‡ªå‹•æ›è¡ŒåŠŸèƒ½
5. é é¢é‚Šè·è¨­å®š

æŠ€è¡“ç´°ç¯€ï¼š
â€¢ ä½¿ç”¨ jsPDF 2.5.1 ç‰ˆæœ¬
â€¢ æ”¯æ´ UTF-8 ä¸­æ–‡å­—ç¬¦
â€¢ A4 é é¢å°ºå¯¸ (210 x 297 mm)
â€¢ æ¨™æº–å­—é«” Helvetica 12pt

æ¸¬è©¦çµæœï¼š
å¦‚æœæ‚¨èƒ½æ­£å¸¸é–‹å•Ÿä¸¦é–±è®€æ­¤ PDF æª”æ¡ˆï¼Œè¡¨ç¤ºæ‰€æœ‰æ¸¬è©¦é …ç›®éƒ½é€šéäº†ã€‚

ç”Ÿæˆæ™‚é–“ï¼š${new Date().toLocaleString()}`,
                        title: 'ç¶œåˆæ¸¬è©¦å ±å‘Š'
                    }
                ];
                
                const results = [];
                
                for (let i = 0; i < tests.length; i++) {
                    const test = tests[i];
                    try {
                        addResult(containerId, `ğŸ”„ æ¸¬è©¦ ${i + 1}: ${test.name}`, 'info');
                        
                        const blob = await DocumentConverter.convertToPdf(test.content, test.title);
                        
                        if (blob.size > 0) {
                            addResult(containerId, `âœ… ${test.name} æˆåŠŸ (${(blob.size / 1024).toFixed(1)} KB)`, 'success');
                            results.push({ ...test, blob, index: i });
                        } else {
                            addResult(containerId, `âŒ ${test.name} å¤±æ•— - æª”æ¡ˆå¤§å°ç‚º 0`, 'error');
                        }
                        
                    } catch (testError) {
                        addResult(containerId, `âŒ ${test.name} å¤±æ•—: ${testError.message}`, 'error');
                    }
                }
                
                if (results.length > 0) {
                    addResult(containerId, `âœ… ç¶œåˆæ¸¬è©¦å®Œæˆï¼æˆåŠŸç”Ÿæˆ ${results.length} å€‹ PDF æª”æ¡ˆ`, 'success');
                    
                    const downloadDiv = document.createElement('div');
                    downloadDiv.className = 'download-area';
                    downloadDiv.innerHTML = `
                        <strong>ğŸ‰ PDF ç¶œåˆæ¸¬è©¦çµæœ</strong><br>
                        æˆåŠŸæ¸¬è©¦: ${results.length} / ${tests.length}<br><br>
                        ${results.map(result => 
                            `<a href="#" class="download-btn" onclick="safeDownload(window.comprehensivePdfBlobs[${result.index}], '${result.name.replace(/\s+/g, '-')}.pdf'); return false;">
                                ğŸ“„ ${result.name}
                            </a>`
                        ).join('')}
                    `;
                    document.getElementById(containerId).appendChild(downloadDiv);
                    window.comprehensivePdfBlobs = results.map(r => r.blob);
                }
                
            } catch (error) {
                addResult(containerId, `âŒ ç¶œåˆæ¸¬è©¦å¤±æ•—: ${error.message}`, 'error');
            }
        }

        // å…¨åŸŸå‡½æ•¸è¨»å†Š
        window.checkPdfLibraries = checkPdfLibraries;
        window.testTextToPdf = testTextToPdf;
        window.testHtmlToPdf = testHtmlToPdf;
        window.testPdfParsing = testPdfParsing;
        window.testPdfToOthers = testPdfToOthers;
        window.testMultiPagePdf = testMultiPagePdf;
        window.testPdfComprehensive = testPdfComprehensive;

        // é é¢è¼‰å…¥å®Œæˆå¾Œè‡ªå‹•æª¢æŸ¥å‡½å¼åº«ç‹€æ…‹
        window.addEventListener('load', () => {
            setTimeout(checkPdfLibraries, 1000);
        });
    </script>
</body>
</html>